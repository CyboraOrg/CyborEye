{
  "name": "Scenario 4: Cloud Infrastructure Attack (AWS)",
  "description": "An attacker uses compromised credentials to create rogue EC2 instances for crypto mining.",
  "events": [
    { "id": "evt-g2h1i0j9", "timestamp": "2025-07-06T03:00:00Z", "event_source": "aws_cloudtrail", "aws_region": "us-east-1", "event_name": "ConsoleLogin", "user_identity": {"type": "IAMUser", "userName": "dev-user"}, "source_ip_address": "203.0.113.55", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36", "response_elements": {"ConsoleLogin": "Success"}, "error_code": null },
    { "id": "evt-k8l7m6n5", "timestamp": "2025-07-06T03:02:00Z", "event_source": "aws_cloudtrail", "aws_region": "us-east-1", "event_name": "ListRoles", "user_identity": {"userName": "dev-user"}, "source_ip_address": "203.0.113.55" },
    { "id": "evt-o4p3q2r1", "timestamp": "2025-07-06T03:03:00Z", "event_source": "aws_cloudtrail", "aws_region": "us-east-1", "event_name": "ListAttachedUserPolicies", "user_identity": {"userName": "dev-user"}, "source_ip_address": "203.0.113.55", "request_parameters": {"userName": "dev-user"} },
    { "id": "evt-s0t9u8v7", "timestamp": "2025-07-06T03:05:00Z", "event_source": "aws_cloudtrail", "aws_region": "us-east-1", "event_name": "RunInstances", "user_identity": {"userName": "dev-user"}, "source_ip_address": "203.0.113.55", "request_parameters": {"instanceType": "c5.24xlarge", "imageId": "ami-0abcdef1234567890", "count": 10}, "response_elements": {"instancesSet": {"items": [{"instanceId": "i-0123456789abcdef0"}]}} },
    { "id": "evt-w6x5y4z3", "timestamp": "2025-07-06T03:05:10Z", "event_source": "aws_cloudtrail", "aws_region": "eu-west-1", "event_name": "RunInstances", "user_identity": {"userName": "dev-user"}, "source_ip_address": "203.0.113.55", "request_parameters": {"instanceType": "p3.16xlarge", "imageId": "ami-0abcdef1234567890", "count": 5}, "response_elements": {"instancesSet": {"items": [{"instanceId": "i-fedcba9876543210"}]}} },
    { "id": "evt-a2b1c0d9", "timestamp": "2025-07-06T03:05:20Z", "event_source": "aws_cloudtrail", "aws_region": "ap-southeast-2", "event_name": "RunInstances", "user_identity": {"userName": "dev-user"}, "source_ip_address": "203.0.113.55", "request_parameters": {"instanceType": "c5.24xlarge", "imageId": "ami-0abcdef1234567890", "count": 10}, "response_elements": {"instancesSet": {"items": [{"instanceId": "i-a1b2c3d4e5f6g7h8"}]}} },
    { "id": "evt-e8f7g6h5", "timestamp": "2025-07-06T03:10:00Z", "event_source": "aws_cloudtrail", "aws_region": "us-east-1", "event_name": "CreateAccessKey", "user_identity": {"userName": "dev-user"}, "source_ip_address": "203.0.113.55", "request_parameters": {"userName": "dev-user"} },
    { "id": "evt-i4j3k2l1", "timestamp": "2025-07-06T03:12:00Z", "event_source": "aws_cloudtrail", "aws_region": "us-east-1", "event_name": "StopLogging", "user_identity": {"userName": "dev-user"}, "source_ip_address": "203.0.113.55", "request_parameters": {"name": "primary-org-trail"} },
    { "id": "evt-m0n9o8p7", "timestamp": "2025-07-06T03:15:00Z", "event_source": "aws_cloudtrail", "aws_region": "us-east-1", "event_name": "PutBucketPolicy", "user_identity": {"userName": "dev-user"}, "source_ip_address": "203.0.113.55", "request_parameters": {"bucketName": "sensitive-data-bucket", "policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Sid\":\"PublicReadGetObject\",\"Effect\":\"Allow\",\"Principal\":\"*\",\"Action\":[\"s3:GetObject\"],\"Resource\":[\"arn:aws:s3:::sensitive-data-bucket/*\"]}]}"} },
    { "id": "evt-q6r5s4t3", "timestamp": "2025-07-06T03:18:00Z", "event_source": "aws_cloudtrail", "aws_region": "us-east-1", "event_name": "CreateUser", "user_identity": {"userName": "dev-user"}, "source_ip_address": "203.0.113.55", "request_parameters": {"userName": "backdoor-user"} },
    { "id": "evt-u2v1w0x9", "timestamp": "2025-07-06T03:18:30Z", "event_source": "aws_cloudtrail", "aws_region": "us-east-1", "event_name": "AttachUserPolicy", "user_identity": {"userName": "dev-user"}, "source_ip_address": "203.0.113.55", "request_parameters": {"userName": "backdoor-user", "policyArn": "arn:aws:iam::aws:policy/AdministratorAccess"} },
    { "id": "evt-y8z7a6b5", "timestamp": "2025-07-06T03:20:00Z", "event_source": "aws_guardduty", "aws_region": "us-east-1", "finding_type": "CryptoCurrency:EC2/BitcoinTool.B!DNS", "resource": {"instanceDetails": {"instanceId": "i-0123456789abcdef0"}} },
    { "id": "evt-c4d3e2f1", "timestamp": "2025-07-06T03:21:00Z", "event_source": "aws_guardduty", "aws_region": "eu-west-1", "finding_type": "CryptoCurrency:EC2/BitcoinTool.B!DNS", "resource": {"instanceDetails": {"instanceId": "i-fedcba9876543210"}} },
    { "id": "evt-g0h9i8j7", "timestamp": "2025-07-06T03:25:00Z", "event_source": "aws_cloudtrail", "aws_region": "us-east-1", "event_name": "DeleteTrail", "user_identity": {"userName": "dev-user"}, "source_ip_address": "203.0.113.55", "request_parameters": {"name": "secondary-audit-trail"} },
    { "id": "evt-k6l5m4n3", "timestamp": "2025-07-06T03:30:00Z", "event_source": "aws_cloudtrail", "aws_region": "us-east-1", "event_name": "UpdateDetector", "user_identity": {"userName": "dev-user"}, "source_ip_address": "203.0.113.55", "request_parameters": {"detectorId": "123abcde456fg", "enable": false} },
    { "id": "evt-o2p1q0r9", "timestamp": "2025-07-06T03:35:00Z", "event_source": "aws_cloudtrail", "aws_region": "us-east-1", "event_name": "ConsoleLogin", "user_identity": {"type": "IAMUser", "userName": "backdoor-user"}, "source_ip_address": "203.0.113.55", "response_elements": {"ConsoleLogin": "Success"} },
    { "id": "evt-s8t7u6v5", "timestamp": "2025-07-06T03:40:00Z", "event_source": "aws_cloudtrail", "aws_region": "us-east-1", "event_name": "TerminateInstances", "user_identity": {"userName": "backdoor-user"}, "source_ip_address": "203.0.113.55", "request_parameters": {"instanceIds": ["i-instanceid1", "i-instanceid2"]} },
    { "id": "evt-w4x3y2z1", "timestamp": "2025-07-06T03:45:00Z", "event_source": "aws_cloudtrail", "aws_region": "us-east-1", "event_name": "DeleteUser", "user_identity": {"userName": "backdoor-user"}, "source_ip_address": "203.0.113.55", "request_parameters": {"userName": "dev-user"} },
    { "id": "evt-a0b9c8d7", "timestamp": "2025-07-06T04:00:00Z", "event_source": "aws_vpc_flow", "src_addr": "172.31.16.8", "dst_addr": "45.55.122.144", "dst_port": 3333, "protocol": "tcp", "action": "ACCEPT" },
    { "id": "evt-e6f5g4h3", "timestamp": "2025-07-06T04:01:00Z", "event_source": "aws_vpc_flow", "src_addr": "172.31.24.12", "dst_addr": "192.241.229.87", "dst_port": 4444, "protocol": "tcp", "action": "ACCEPT" }
  ]
}
